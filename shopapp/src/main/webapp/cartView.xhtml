<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">

<h:head>

</h:head>

<h:body>
	<!-- <p:messages id="messages" /> -->
	
	<h:form id="form">
	<p:growl id="messages" />
	<p:dataTable var="cartItem" value="#{cartView.thecart}" id="cartTable">

		<p:column headerText="Name">
			<h:outputText value="#{cartItem.product.name}" />
		</p:column>

		<p:column headerText="Description">
			<h:outputText value="#{cartItem.product.description}" />
		</p:column>

		<p:column headerText="Price">
			<h:outputText value="#{cartItem.product.price}" />
		</p:column>

		<p:column headerText="Image">
			<img src="#{cartItem.product.imageFile}" />
		</p:column>

		<p:column headerText="Quantity">
			
			
			<h:inputText value="#{cartItem.amount}" style="padding-left: 10px"/>  
			
		</p:column>

		<p:column headerText="Item Total">
			<h:outputText value="#{cartItem.totalPrice}" />
		</p:column>

		
	</p:dataTable>
	
	<p:commandButton value="Update" icon="ui-icon-arrowrefresh-1-e" action="#{cartView.update}" update=":form"/>
	<p:commandButton value="Checkout" icon="ui-icon-arrowrefresh-1-e" oncomplete="PF('customerLoginDialog').show()"/>
	</h:form>

	<p:dialog widgetVar="customerLoginDialog" closeOnEscape="true"
		modal="true" header="Customer Login">
		<h:form id="customerLoginForm">
			<p:messages />
			<p:focus />
			<p:panelGrid columns="2">
				First name:
				<p:inputText value="#{customerView.customer.fname}" />
				Email:
				<p:inputText value="#{customerView.customer.email}" />
			</p:panelGrid>
	
			<p:commandButton value="login" action="#{cartView.checkout(customerView.customer)}"
				oncomplete="handleDialogSubmit(args, 'customerLoginForm')" />

		</h:form>
	</p:dialog>

	<!-- Confirmation dialog before removing CartItem from the list -->
	
	<script type="text/javascript">
		function handleDialogSubmit(args, dialogName) {
			if (!args.validationFailed) {
				PF(dialogName).hide();
			}
		}
	</script>
	
	<h:form>
		<p:confirmDialog global="true" closeOnEscape="true">
			<p:commandButton value="Yes" type="button"
				styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
			<p:commandButton value="No" type="button"
				styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
		</p:confirmDialog>
	</h:form>


</h:body>
</html>